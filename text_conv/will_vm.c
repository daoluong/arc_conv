static uchar bloodycall_tab[] = {
//	  0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F
	0xE0, 0x09, 0xC2, 0x06, 0xC0, 0x01, 0x04, 0x80,  0xE0, 0x80, 0x00, 0x01, 0x02, 0xE0, 0xE0, 0xE0,
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 1
	0xE0, 0x8A, 0x03, 0x89, 0xE0, 0x8B, 0x01, 0xE0,  0x04, 0x03, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 2
	0x03, 0xE0, 0x01, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 3
	0xE0, 0x84, 0x85, 0x86, 0xE0, 0x03, 0x89, 0x01,  0x8B, 0x02, 0x05, 0x0F, 0x07, 0x0C, 0x03, 0x03, // 4
	0x80, 0x04, 0x01, 0xE0, 0x80, 0x00, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 5
	0xE0, 0x81, 0x00, 0x02, 0x07, 0x04, 0xD2, 0x07,  0x08, 0x01, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 6
	0x07, 0x80, 0x00, 0x89, 0x01, 0xE0, 0xE0, 0xE0,  0x07, 0x00, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 7

	0xE0, 0xE0, 0x02, 0x00, 0xE0, 0x01, 0xE0, 0xE0,  0xE0, 0x00, 0xE0, 0x00, 0x02, 0xE0, 0x00, 0xE0, // 8
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 9
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0x00, 0xE0,  0x0F, 0x00, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // A
	0xE0, 0x04, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0x02, 0x02, 0xE0, 0xE0, 0x03, 0x01, 0xE0, 0xE0, // B
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // C
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // D
	0xE0, 0xE0, 0x00, 0xE0, 0xE0, 0xE0, 0x01, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // E
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xC8 };

static int bloodycall_asm_local(FILE *fi, uint **m) {
	uint a, b, n, i = 0, p = 0; uchar t[32];

	will_jmp(fi, &i, 0, bloodycall_tab);
	if(!(*m = malloc(i << 2))) return -1;
	**m = i; if(i > 1) {
	  if(fseek(fi, 0, SEEK_SET)) return -1;
	  will_jmp(fi, *m, i, bloodycall_tab);
	}
	if(fseek(fi, 0, SEEK_SET)) return -1;

	for(;;) {
	  for(n = **m, i = 1; i < n; i++) if((*m)[i] == p) { printf("_x%04X:\n", p); break; }
	  if((a = fgetc(fi)) == EOF) break; p++; a = WILL_ROR2(a);
	  printf("m1 0x%02X", a);

	  b = bloodycall_tab[a]; if(b & 0x1F) WILL_READ(t, b & 0x1F); b >>= 5;

	  switch(a) {

	  case 0x01:	  // relative jump
	    *(uint*)(t + 5) += p + 1;
	    will_printf(t, "122x"); break;

	  case 0x06:	  // absolute jump
	    will_printf(t, "x"); break;

	  case 0x02:
	    n = t[0];
	    printf(", 0x%02X", n);
	    if(t[1]) printf("\n%%error\n");
	    if(n) do {
	      WILL_READ(t, 2);
	      printf("\nm2 0x%04X", *(ushort*)t);
	      if(will_asmstr(fi, &p)) return -1;
	      WILL_READ(t, 4); will_printf(t, "121");
	      if((a = t[3]) == 3) {
	        WILL_READ(t, 7); will_printf(t, "1212");
	        if(t[6]) printf("\n%%error");
	      } else if(a == 6) {
	        WILL_READ(t, 5); will_printf(t, "4");
	        if(t[4]) printf("\n%%error");
	      } else if(a == 7) if(will_asmstr(fi, &p)) return -1;
	    } while(--n);
	    break;

	  case 0x42: will_printf(t, "2111");
	    if(will_asmstr(fi, &p)) return -1;
	    break;

	  case 0x03: will_printf(t, "1212"); break;
	  case 0x21: will_printf(t, "12124"); break;
	  case 0x23: will_printf(t, "122211"); break;
	  case 0x25: will_printf(t, "111121211"); break;
	  case 0x41: will_printf(t, "211"); break;
	  case 0x43: will_printf(t, "1221"); break;
	  case 0x48: will_printf(t, "122411"); break;
	  case 0x4B: will_printf(t, "122424"); break;
	  case 0x4D: will_printf(t, "1122222"); break;
	  case 0x68: will_printf(t, "2222"); break;
	  case 0x4A: will_printf(t, "122"); break;
	  case 0x64: will_printf(t, "1222"); break;
	  case 0x66: will_printf(t, "12212424"); break;
	  case 0x28: will_printf(t, "112"); break;
	  case 0xA8: will_printf(t, "1111122222"); break;

	  case 0x4C: case 0x67: case 0x70: case 0x78:
	    will_printf(t, "1114"); break;

	  case 0x46: case 0x73:
	    will_printf(t, "2241"); break;

	  case 0x51: case 0x65: case 0xB1:
	    will_printf(t, "22"); break;

	  case 0x45: case 0x4E: case 0x4F: case 0xBC:
	    will_printf(t, "111"); break;

	  case 0x22: case 0x29: case 0x30:
	    will_printf(t, "12"); break;

	  case 0x0C: case 0x82: case 0x8C:
	    will_printf(t, "2"); break;

	  case 0x49: case 0x63: case 0xB8: case 0xB9:
	    will_printf(t, "11"); break;

	  case 0x05: case 0x0B: case 0x26: case 0x32: case 0x47: case 0x52:
	  case 0x61: case 0x69: case 0x74: case 0x85: case 0xBD: case 0xE6:
	    will_printf(t, "1"); break;

	  case 0xFF:
	    will_printf(t, "44"); break;

	  default:
	    if(b == 7) printf("\n%%error");
	  }

	  if(!b) {
	    LODSB; p++; if(a) printf("\n%%error");
	  } else if(b == 4) {
	    if(will_asmstr(fi, &p)) return -1;
	  }
	  putchar('\n');
	}
	return 0;
}

static uchar laughter_tab[] = {
//	  0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F
	0xE0, 0x09, 0xC2, 0x06, 0xC0, 0x00, 0x04, 0x80,	 0xE0, 0x80, 0x00, 0x01, 0x02, 0xE0, 0xE0, 0xE0,
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 1
	0xE0, 0x84, 0x03, 0x87, 0xE0, 0x89, 0x01, 0xE0,  0xE0, 0x03, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 2
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 3
	0xE0, 0x83, 0x84, 0x86, 0xE0, 0x03, 0x89, 0x01,  0x8B, 0x02, 0x03, 0x0B, 0x01, 0x04, 0x03, 0x03, // 4
	0x80, 0x04, 0x01, 0xE0, 0x80, 0x00, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 5
	0xE0, 0x81, 0xE0, 0xE0, 0x05, 0xE0, 0xE0, 0xE0,  0x06, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 6
	0xE0, 0x80, 0x00, 0x89, 0x01, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 7

	0xE0, 0xE0, 0x02, 0x00, 0xE0, 0x01, 0x01, 0xE0,  0xE0, 0x00, 0xE0, 0x00, 0x02, 0xE0, 0x00, 0xE0, // 8
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 9
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // A
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0x82, 0xE0,  0x02, 0x01, 0xE0, 0xE0, 0xE0, 0x01, 0xE0, 0xE0, // B
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // C
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // D
	0xE0, 0xE0, 0x00, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // E
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xC0 };

static int laughter_asm_local(FILE *fi, uint **m) {
	uint a, b, n, i = 0, p = 0; uchar t[32];

	will_jmp(fi, &i, 0, laughter_tab);
	if(!(*m = malloc(i << 2))) return -1;
	**m = i; if(i > 1) {
	  if(fseek(fi, 0, SEEK_SET)) return -1;
	  will_jmp(fi, *m, i, laughter_tab);
	}
	if(fseek(fi, 0, SEEK_SET)) return -1;

	for(;;) {
	  for(n = **m, i = 1; i < n; i++) if((*m)[i] == p) { printf("_x%04X:\n", p); break; }
	  if((a = fgetc(fi)) == EOF) break; p++; a = WILL_ROR2(a);
	  printf("m1 0x%02X", a);

	  b = laughter_tab[a]; if(b & 0x1F) WILL_READ(t, b & 0x1F); b >>= 5;

	  switch(a) {

	  case 0x01:	  // relative jump
	    *(uint*)(t + 5) += p + 1;
	    will_printf(t, "122x"); break;

	  case 0x06:	  // absolute jump
	    will_printf(t, "x"); break;

	  case 0x02:
	    n = t[0];
	    printf(", 0x%02X", n);
	    if(t[1]) printf("\n%%error\n");
	    if(n) do {
	      WILL_READ(t, 2);
	      printf("\nm2 0x%04X", *(ushort*)t);
	      if(will_asmstr(fi, &p)) return -1;
	      WILL_READ(t, 4); will_printf(t, "121");
	      if((a = t[3]) == 3) {
	        WILL_READ(t, 7); will_printf(t, "1212");
	        if(t[6]) printf("\n%%error");
	      } else if(a == 6) {
	        WILL_READ(t, 5); will_printf(t, "4");
	        if(t[4]) printf("\n%%error");
	      } else if(a == 7) if(will_asmstr(fi, &p)) return -1;
	    } while(--n);
	    break;

	  case 0x42: will_printf(t, "211");
	    if(will_asmstr(fi, &p)) return -1;
	    break;

	  case 0x03: will_printf(t, "1212"); break;
	  case 0x21: will_printf(t, "121"); break;
	  case 0x23: will_printf(t, "1222"); break;
	  case 0x25: will_printf(t, "1111212"); break;
	  case 0x41: will_printf(t, "21"); break;
	  case 0x43: will_printf(t, "1221"); break;
	  case 0x48: will_printf(t, "122411"); break;
	  case 0x4B: will_printf(t, "12242"); break;
	  case 0x4D: will_printf(t, "112"); break;
	  case 0x51: will_printf(t, "22"); break;
	  case 0x68: will_printf(t, "222"); break;
	  case 0x64: will_printf(t, "122"); break;

	  case 0x46: case 0x73:
	    will_printf(t, "2241"); break;

	  case 0x45: case 0x4E: case 0x4F:
	    will_printf(t, "111"); break;

	  case 0x22: case 0x29: case 0x4A:
	    will_printf(t, "12"); break;

	  case 0x0C: case 0x82: case 0x8C: case 0xB6:
	    will_printf(t, "2"); break;

	  case 0x49: case 0xB8:
	    will_printf(t, "11"); break;

	  case 0x0B: case 0x26: case 0x47: case 0x4C: case 0x52: case 0x61:
	  case 0x74: case 0x85: case 0x86: case 0xB9: case 0xBD:
	    will_printf(t, "1"); break;

	  default:
	    if(b == 7) printf("\n%%error");
	  }

	  if(!b) {
	    LODSB; p++; if(a) printf("\n%%error");
	  } else if(b == 4) {
	    if(will_asmstr(fi, &p)) return -1;
	  }
	  putchar('\n');
	}
	return 0;
}

static uchar yumemiru_tab[] = {
//	  0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F
	0xE0, 0x09, 0xC2, 0x06, 0xC0, 0x00, 0x04, 0x80,  0x01, 0x80, 0x00, 0x01, 0x02, 0xE0, 0xE0, 0xE0,
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 1
	0xE0, 0x83, 0x03, 0x87, 0xE0, 0x88, 0x01, 0xE0,  0x02, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 2
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 3
	0xE0, 0x83, 0x84, 0x86, 0xE0, 0x03, 0x89, 0x01,  0x8A, 0x02, 0x03, 0x0B, 0x00, 0x04, 0xE0, 0x03, // 4
	0x80, 0x04, 0x01, 0xE0, 0x80, 0x00, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 5
	0xE0, 0x81, 0xE0, 0xE0, 0x03, 0xE0, 0xE0, 0xE0,  0x06, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 6
	0xE0, 0xE0, 0xE0, 0x89, 0x01, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 7

	0xE0, 0xE0, 0x02, 0x00, 0xE0, 0x01, 0x01, 0xE0,  0xE0, 0x00, 0xE0, 0x00, 0x02, 0xE0, 0x00, 0xE0, // 8
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 9
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // A
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0x82, 0xE0,  0x02, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // B
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // C
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // D
	0xE0, 0xE0, 0x00, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // E
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xC0 };

static int yumemiru_asm_local(FILE *fi, uint **m) {
	uint a, b, n, i = 0, p = 0; uchar t[32];

	will_jmp(fi, &i, 0, yumemiru_tab);
	if(!(*m = malloc(i << 2))) return -1;
	**m = i; if(i > 1) {
	  if(fseek(fi, 0, SEEK_SET)) return -1;
	  will_jmp(fi, *m, i, yumemiru_tab);
	}
	if(fseek(fi, 0, SEEK_SET)) return -1;

	for(;;) {
	  for(n = **m, i = 1; i < n; i++) if((*m)[i] == p) { printf("_x%04X:\n", p); break; }
	  if((a = fgetc(fi)) == EOF) break; p++; a = WILL_ROR2(a);
	  printf("m1 0x%02X", a);

	  b = yumemiru_tab[a]; if(b & 0x1F) WILL_READ(t, b & 0x1F); b >>= 5;

	  switch(a) {

	  case 0x01:	  // relative jump
	    *(uint*)(t + 5) += p + 1;
	    will_printf(t, "122x"); break;

	  case 0x06:	  // absolute jump
	    will_printf(t, "x"); break;

	  case 0x02:
	    n = t[0];
	    printf(", 0x%02X", n);
	    if(t[1]) printf("\n%%error\n");
	    if(n) do {
	      WILL_READ(t, 2);
	      printf("\nm2 0x%04X", *(ushort*)t);
	      if(will_asmstr(fi, &p)) return -1;
	      WILL_READ(t, 4); will_printf(t, "121");
	      if((a = t[3]) == 3) {
	        WILL_READ(t, 7); will_printf(t, "1212");
	        if(t[6]) printf("\n%%error");
	      } else if(a == 6) {
	        WILL_READ(t, 5); will_printf(t, "4");
	        if(t[4]) printf("\n%%error");
	      } else if(a == 7) if(will_asmstr(fi, &p)) return -1;
	    } while(--n);
	    break;

	  case 0x42: will_printf(t, "211");
	    if(will_asmstr(fi, &p)) return -1;
	    break;

	  case 0x03: will_printf(t, "1212"); break;
	  case 0x23: will_printf(t, "1222"); break;
	  case 0x25: will_printf(t, "1111211"); break;
	  case 0x41: will_printf(t, "21"); break;
	  case 0x43: will_printf(t, "1221"); break;
	  case 0x48: will_printf(t, "12241"); break;
	  case 0x4B: will_printf(t, "12242"); break;
	  case 0x4D: will_printf(t, "112"); break;
	  case 0x51: will_printf(t, "22"); break;
	  case 0x68: will_printf(t, "222"); break;

	  case 0x46: case 0x73:
	    will_printf(t, "2241"); break;

	  case 0x45: case 0x4F:
	    will_printf(t, "111"); break;

	  case 0x21: case 0x22: case 0x4A: case 0x64:
	    will_printf(t, "12"); break;

	  case 0x0C: case 0x82: case 0x8C: case 0xB6:
	    will_printf(t, "2"); break;

	  case 0x28: case 0x49: case 0xB8:
	    will_printf(t, "11"); break;

	  case 0x08: case 0x0B: case 0x26: case 0x47: case 0x52: case 0x61:
	  case 0x74: case 0x85: case 0x86:
	    will_printf(t, "1"); break;

	  default:
	    if(b == 7) printf("\n%%error");
	  }

	  if(!b) {
	    LODSB; p++; if(a) printf("\n%%error");
	  } else if(b == 4) {
	    if(will_asmstr(fi, &p)) return -1;
	  }
	  putchar('\n');
	}
	return 0;
}

static uchar enzai_tab[] = {
//	  0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F
	0xE0, 0x09, 0xC2, 0x06, 0xC0, 0xE0, 0x04, 0x80,  0xE0, 0x80, 0x00, 0x01, 0x02, 0xE0, 0xE0, 0xE0,
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 1
	0xE0, 0x81, 0x00, 0x85, 0xE0, 0x84, 0x03, 0x01,  0x01, 0x01, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 2
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 3
	0xE0, 0x83, 0x84, 0x86, 0xE0, 0x03, 0x89, 0x01,  0x8A, 0x02, 0x01, 0xE0, 0xE0, 0x04, 0xE0, 0x03, // 4
	0x80, 0x04, 0x01, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 5
	0xE0, 0x81, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 6
	0xE0, 0x80, 0x00, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 7

	0xE0, 0xE0, 0xE0, 0x00, 0xE0, 0x01, 0xE0, 0x02,  0x01, 0x00, 0x01, 0x00, 0x02, 0xE0, 0xE0, 0xE0, // 8
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // 9
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // A
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // B
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // C
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // D
	0x80, 0xE0, 0x00, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, // E
	0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,  0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xC0 };

static int enzai_asm_local(FILE *fi, uint **m) {
	uint a, b, n, i = 0, p = 0; uchar t[32];

	enzai_jmp(fi, &i, 0, enzai_tab);
	if(!(*m = malloc(i << 2))) return -1;
	**m = i; if(i > 1) {
	  if(fseek(fi, 0, SEEK_SET)) return -1;
	  enzai_jmp(fi, *m, i, enzai_tab);
	}
	if(fseek(fi, 0, SEEK_SET)) return -1;

	for(;;) {
	  for(n = **m, i = 1; i < n; i++) if((*m)[i] == p) { printf("_x%04X:\n", p); break; }
	  if((a = fgetc(fi)) == EOF) break; p++; a = WILL_ROR2(a);
	  printf("m1 0x%02X", a);

	  b = enzai_tab[a]; if(b & 0x1F) WILL_READ(t, b & 0x1F); b >>= 5;

	  switch(a) {

	  case 0x01:	  // relative jump
	    *(uint*)(t + 5) += p + 1;
	    will_printf(t, "122x"); break;

	  case 0x06:	  // absolute jump
	    will_printf(t, "x"); break;

	  case 0x02:
	    n = t[0];
	    printf(", 0x%02X", n);
	    if(t[1]) printf("\n%%error\n");
	    if(n) do {
	      WILL_READ(t, 2);
	      printf("\nm2 0x%04X", *(ushort*)t);
	      if(will_asmstr(fi, &p)) return -1;
	      WILL_READ(t, 1); will_printf(t, "1");
	      if((a = t[0]) == 3) {
	        WILL_READ(t, 7); will_printf(t, "1212");
	        if(t[6]) printf("\n%%error");
	      } else if(a == 6) {
	        WILL_READ(t, 5); will_printf(t, "4");
	        if(t[4]) printf("\n%%error");
	      } else if(a == 7) if(will_asmstr(fi, &p)) return -1;
	    } while(--n);
	    break;

	  case 0x42: will_printf(t, "211");
	    if(will_asmstr(fi, &p)) return -1;
	    break;

	  case 0x23: will_printf(t, "122"); break;
	  case 0x03: will_printf(t, "1212"); break;
	  case 0x41: will_printf(t, "21"); break;
	  case 0x43: will_printf(t, "1221"); break;
	  case 0x51: will_printf(t, "22"); break;
	  case 0x48: will_printf(t, "12241"); break;
	  case 0x4D: will_printf(t, "112"); break;

	  case 0x46:
	    will_printf(t, "2241"); break;

	  case 0x49:
	    will_printf(t, "11"); break;

	  case 0x26: case 0x45: case 0x4F:
	    will_printf(t, "111"); break;

	  case 0x25:
	    will_printf(t, "1111"); break;

	  case 0x0B: case 0x21: case 0x27: case 0x28: case 0x29: case 0x47: case 0x4A:
	  case 0x52: case 0x61: case 0x85: case 0x88: case 0x8A:
	    will_printf(t, "1"); break;

	  case 0x0C: case 0x87: case 0x8C:
	    will_printf(t, "2"); break;

#if 0
	  case 0x25: will_printf(t, "1111211"); break;
	  case 0x48: will_printf(t, "12241"); break;
	  case 0x4B: will_printf(t, "12242"); break;
	  case 0x51: will_printf(t, "22"); break;
	  case 0x68: will_printf(t, "222"); break;

	  case 0x46: case 0x73:
	    will_printf(t, "2241"); break;

	  case 0x45: case 0x4F:
	    will_printf(t, "111"); break;

	  case 0x21: case 0x22: case 0x4A: case 0x64:
	    will_printf(t, "12"); break;
#endif

	  default:
	    if(b == 7) printf("\n%%error");
	  }

	  if(!b) {
	    LODSB; p++; if(a) printf("\n%%error");
	  } else if(b == 4) {
	    if(will_asmstr(fi, &p)) return -1;
	  }
	  putchar('\n');
	}
	return 0;
}
